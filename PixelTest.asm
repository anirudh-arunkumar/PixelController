; Simple test for the NeoPixel peripheral

ORG 0

	;2 - MODE_NUMBER
	LOADI  &B00000000
	SHIFT  8
	ADDI   &B00000000
	OUT    PXL_D
	LOADI  2
	OUT    MODE_NUMBER
	CALL   DELAY
	
	;TURN THE LIGHTS OFF
	LOADI  0
	OUT    MODE_ALL
	CALL   DELAY
	OUT    MODE_INVERT
	
	;ECE - MODE_LETTER
	LOADI  &B11111111
	SHIFT  8
	ADDI   &B11111111
	OUT    MODE_LETTER
	CALL 	DELAY
	
	
	
	;TURN THE LIGHTS OFFsjk
	LOADI  0
	OUT    MODE_ALL
	CALL   DELAY
	OUT    MODE_INVERT
	
	;0 - MODE_NUMBER
	LOADI  &B11110000
	SHIFT  8
	ADDI   &B11110011
	OUT    PXL_D
	LOADI  0
	OUT    MODE_NUMBER
	CALL   DELAY
	
	;TURN THE LIGHTS OFF
	LOADI  0
	OUT    MODE_ALL
	CALL   DELAY
	OUT    MODE_INVERT
	
	;3 - MODE_NUMBER
	LOADI  &B11110000
	SHIFT  8
	ADDI   &B11110011
	OUT    PXL_D
	LOADI  3
	OUT    MODE_NUMBER
	CALL   DELAY
	
	;TURN THE LIGHTS OFF
	LOADI  0
	OUT    MODE_ALL
	CALL   DELAY
	OUT    MODE_INVERT
	
	;1 - MODE_NUMBER
	LOADI  &B11110000
	SHIFT  8
	ADDI   &B11110011
	OUT    PXL_D
	LOADI  1
	OUT    MODE_NUMBER
	CALL   DELAY
	
	;TURN THE LIGHTS OFF
	LOADI  0
	OUT    MODE_ALL
	CALL   DELAY
	OUT    MODE_INVERT
	
	;1 - MODE_NUMBER
	LOADI  &B11110000
	SHIFT  8
	ADDI   &B11110011
	OUT    PXL_D
	LOADI  1
	OUT    MODE_NUMBER
	CALL   DELAY
	
	;TURN THE LIGHTS OFF
	LOADI  0
	OUT    MODE_ALL
	CALL   DELAY
	OUT    MODE_INVERT
	
	;ORANGE - 16 bit
	CALL   DELAY
	LOADI  1
	OUT    PXL_A
	LOADI  &B00001111
	SHIFT  8
	ADDI   &B00110111
	OUT    MODE_16bit
	CALL   DELAY
	
	;PURPLE - 24 bit
	LOADI  3
	OUT    PXL_A
	LOADI  &B00000011
	SHIFT  8
	ADDI   &B11111111
	SHIFT  8
	ADDI   &B11000111
	OUT    MODE_24bit
	LOADI 0
	OUT    MODE_24bit
	CALL   DELAY
	
	;RED - ALL
	LOADI  &B11111000
	SHIFT  8
	ADDI   &B00000000
	OUT    MODE_ALL
	CALL   DELAY
	;TURN THE LIGHTS OFF
	LOADI  0
	OUT    MODE_ALL
	CALL   DELAY
	OUT    MODE_INVERT
	
	;GREEN - 16 BIT
	LOADI  5
	OUT    PXL_A
	LOADI  &B00000111
	SHIFT 8
	ADDI   &B11100000
	OUT    MODE_16bit
	CALL   DELAY
	
	;ORANGE - PURPLE - PURPLE: AUTO INCREMENT 
	LOADI 0
	OUT	PXL_A
	LOADI &B11111000
	SHIFT 8
	ADDI  &B00000000
	STORE Color
	OUT  MODE_INC
	LoopAI1:
		LOAD Color
		OUT MODE_INC
		CALL   DELAY2
		LOAD Loop32
		ADDI -1
		STORE Loop32
		JPOS LoopAI1
		LOADI 63
		STORE Loop32
	LOADI 64
	OUT	PXL_A
	LOADI  &B00001111
	SHIFT  8
	ADDI   &B10000000
	STORE Color
	OUT  MODE_INC
	LoopAI2:
		LOAD Color
		OUT MODE_INC
		CALL   DELAY2
		LOAD Loop32
		ADDI -1
		STORE Loop32
		JPOS LoopAI2
		LOADI 63
		STORE Loop32
	LOADI 128
	OUT	PXL_A
	LOADI &B00000000
	SHIFT 8
	ADDI  &B00011111
	STORE Color
	;OUT  MODE_INC
	LoopAI3:
		LOAD Color
		OUT MODE_INC
		CALL   DELAY2
		LOAD Loop32
		ADDI -1
		STORE Loop32
		JPOS LoopAI3
		LOADI 63
		STORE Loop32
	CALL   DELAY
		
	;TURN THE LIGHTS GREEN
	LOADI  &B00001111
	SHIFT  8
	ADDI   &B10000000
	OUT    MODE_ALL
	CALL   DELAY

		
	;ADVANCED INCREMENT 
	LOADI 32
	OUT	PXL_A
	LOADI &B111110000
	SHIFT 8
	ADDI  &B00000000
	STORE Color
	OUT  PXL_D
	LOADI 5
	OUT MODE_ADVINC
	
	
	LoopADVI:
		LOAD Color
		OUT PXL_D
		CALL   DELAY2
		LOAD Loop32
		ADDI -1
		STORE Loop32
		JPOS LoopADVI
		LOADI 32
		STORE Loop32
		
	CALL DELAY
	
	
	;TURN THE LIGHTS OFF
	LOADI  0
	OUT    MODE_ALL
	CALL   DELAY
	OUT    MODE_INVERT
	
	
	;ODD
	LOADI &B00000000
	SHIFT 8
	ADDI  &B00110011
	OUT MODE_ODD

	CALL   DELAY
	OUT MODE_INVERT
	
	CALL   DELAY
	OUT MODE_INVERT
	
	CALL   DELAY
	OUT  MODE_INVERT
	

	
	
	
	

Loop:
	Jump Loop
Delay:
	OUT Timer
WaitingLoop:
		IN Timer
		ADDI -30
		JNEG WaitingLoop
		RETURN

Delay2:
	OUT Timer
WaitingLoop2:
		IN Timer
		ADDI -1
		JNEG WaitingLoop2
		RETURN

Delay3:
	OUT Timer
WaitingLoop3:
		IN Timer
		ADDI -3
		JNEG WaitingLoop3
		RETURN
	

Loop32:    DW 63
Color: 	   DW &B0000000000
; IO address constants
Switches:  EQU 000
LEDs:      EQU 001
Timer:     EQU 002
Hex0:      EQU 004
Hex1:      EQU 005

PXL_A:     EQU &H0B0
PXL_D:     EQU &H0B1
MODE_16bit: EQU &H0B2
MODE_24bit: EQU &H0B3
MODE_ALL:  EQU &H0B4
MODE_INC:  EQU &H0B5
MODE_ADVINC: EQU &H0B6
MODE_LETTER:  EQU &H0B7
MODE_INVERT: EQU &H0B8
MODE_UNSET: EQU &H0B9
MODE_SHIFT: EQU &H0BA
MODE_NUMBER: EQU &H0BB
MODE_EVEN: EQU &H0BC
MODE_ODD: EQU &H0BD
